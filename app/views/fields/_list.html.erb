<% @compteur=1 %>
<% @pills=1 %>
<!-- nav -->
  <ul class="nav nav-tabs" style="margin-bottom: 5px;">
    <% parent_fields.each do |parent_field|  %>
      <li class="<%= ' ' + (@pills == 1 ? 'active' : '') %>">
        <!-- <a data-toggle="tab" href="#pills<%= @pills %>"><%= parent_field %></a> -->
        <%= link_to parent_field, '#pills'+@pills.to_s, 'data-toggle'=>'tab' %>
      </li>
      <% @pills+=1 %>
    <% end %>
    <% @pills=1 %>
    <%= link_to 'Tout afficher','#', :class=>'btn btn-default openall', :id=>'openall', :style=>'float: right;' %>
    <%= link_to 'Tout fermer','#', :class=>'btn btn-default closeall', :id=>'closeall', :style=>'display: none; float: right;' %>
  </ul>
<!-- content -->
  <div class="tab-content">
  <% parent_fields.each do |parent_field|  %>
    <div id="pills<%= @pills %>" class="tab-pane fade<%= ' ' + (@pills == 1 ? 'active in' : '') %>">
      <div class="panel-group text-center" id="accordion<%= @pills %>">
        <% fields.where(parent_id: parent_field.id).each do |field|  %>
          <div class="panel panel-default">
            <a data-toggle="collapse" data-parent="#accordion<%= @pills %>" href="#collapse<%= @compteur %>" style="text-decoration: none;color: black;">
            <div class="row panel-heading" style="background-color: transparent !important;">
                <h3 class="panel-title text-center col-md-12">
                  <%= field %>
                </h3>
            </div>
            </a>
            <div id="collapse<%= @compteur %>" class="panel-collapse collapse text-center">
              <div class="panel-body text-center">
                <% field.features.each do |feature| %>
                  <div class="col-md-3">
                      <%= render partial: 'features/badge', locals: { feature: feature, inactive: !project.has_feature?(feature) } %>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        <% @compteur+=1 %>
        <% end %>
      </div>
      </div>
    <% @pills+=1 %>
    <% end %>
  </div>

<script>

$('.closeall').click(function(){
  $('.panel-collapse.in')
    .collapse('hide');
  $('#openall').show();
$('#closeall').hide();
});
$('.openall').click(function(){
  $('.panel-collapse:not(".in")')
    .collapse('show');
  $('#closeall').show();
  $('#openall').hide();
});

</script>
